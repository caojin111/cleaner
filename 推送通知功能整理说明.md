# 推送通知功能整理说明

## 概述
本文档整理了CleanUp AI应用中所有会发送推送通知的行为，以及最新的修改情况。

## 推送通知行为分类

### 1. 删除文件相关推送（已禁用）
**位置**: `RecycleBinManager.swift`

#### 已禁用的推送类型：
- **单个文件删除通知** (`sendDeleteNotification`)
  - 触发时机：用户删除单个照片/视频时
  - 内容：`"文件已删除"` + `"文件名 已移至回收站"`
  - 状态：已禁用

- **批量文件删除通知** (`sendBatchDeleteNotification`)
  - 触发时机：批量删除文件时
  - 内容：`"批量删除完成"` + `"已将 X 个文件移至回收站"`
  - 状态：已禁用

- **批量永久删除通知** (`sendBatchPermanentDeleteNotification`)
  - 触发时机：从回收站永久删除所有文件时
  - 内容：`"批量永久删除完成"` + `"已永久删除 X 个文件"`
  - 状态：已禁用

- **删除错误通知** (`sendDeleteErrorNotification`)
  - 触发时机：删除操作失败时
  - 内容：`"删除失败"` + `"批量删除过程中发生错误"`
  - 状态：已禁用

#### 修改说明：
- 所有删除相关的推送通知已被注释掉
- 添加了日志记录，显示"推送通知已禁用"
- 删除功能正常工作，只是不再发送推送

### 2. 每日清理提醒推送（保留）
**位置**: `NotificationManager.swift`

#### 保留的推送类型：
- **每日清理提醒** (`scheduleDailyCleanupReminder`)
  - 触发时机：每天20:00定时发送
  - 内容：`"CleanUp AI"` + `"Time for daily cleanup! Keep your device running smoothly."`
  - 状态：保留，用户可在More页面开启/关闭
  - 功能：提醒用户进行日常清理

#### 相关功能：
- 用户可在More页面通过开关控制
- 需要通知权限授权
- 支持应用图标附件

### 3. 测试通知推送（保留）
**位置**: `NotificationManager.swift`

#### 保留的推送类型：
- **测试通知** (`sendTestNotification`)
  - 触发时机：开发测试时手动调用
  - 内容：`"CleanUp AI"` + `"Test notification - Daily cleanup reminder is working!"`
  - 状态：保留，用于功能测试
  - 延迟：5秒后发送

## 推送通知管理

### 权限管理
- 应用启动时会请求通知权限
- 用户可在系统设置中管理权限
- 每日提醒功能需要权限才能正常工作

### 通知管理功能
- **获取待处理通知**: `getPendingNotifications()`
- **清除所有通知**: `clearAllNotifications()`
- **检查提醒状态**: `isDailyReminderScheduled()`
- **移除每日提醒**: `removeDailyCleanupReminder()`

## 用户设置

### More页面通知设置
- 每日清理提醒开关
- 实时显示通知权限状态
- 支持一键开启/关闭提醒

### 通知内容本地化
- 支持多语言显示
- 根据系统语言自动切换

## 技术实现

### 通知管理器
- 单例模式：`NotificationManager.shared`
- 异步操作支持
- 完整的错误处理
- 详细的日志记录

### 通知内容
- 支持标题、正文、声音
- 支持应用图标附件
- 支持徽章数字
- 支持定时触发

## 总结

经过本次修改，应用中的推送通知行为如下：

1. **已禁用**：所有删除文件相关的推送通知
2. **保留**：每日清理提醒（用户可控）
3. **保留**：测试通知（开发用途）

这样的设计既满足了用户去掉删除推送的需求，又保留了有用的提醒功能，提供了良好的用户体验。

## 修改记录

- **2025-01-XX**: 禁用删除文件相关的所有推送通知
- 添加了详细的日志记录
- 保持了删除功能的正常工作
- 用户反馈：删除推送过于频繁，影响使用体验 